# 智普AI内容审核集成说明

## 功能概述

本项目已集成智普AI API，用于对用户发布的宠物信息进行内容审核，确保内容不包含粗鲁、色情、低俗等不当词语。

## 集成内容

### 1. 智普AI服务类 (`ZhipuAIService.swift`)
- 位置：`ios/Runner/Models/ZhipuAIService.swift`
- 功能：封装智普AI API调用，提供内容审核服务
- API密钥：已配置（请在生产环境中使用环境变量管理）

### 2. HUD加载提示 (`HUDView.swift`)
- 位置：`ios/Runner/View/HUDView.swift`
- 功能：提供用户友好的加载提示界面

### 3. 内容审核流程
- 在用户点击"保存"按钮时触发
- 显示"内容审核中..."提示
- 调用智普AI进行内容检查
- 根据审核结果决定是否继续保存流程

## 使用流程

1. **用户填写宠物信息**：包括名字、年龄、描述等
2. **点击保存按钮**：触发内容审核流程
3. **显示HUD**：提示"内容审核中..."
4. **调用智普AI**：检查内容是否包含不当词语
5. **审核结果处理**：
   - 通过：继续保存流程，显示"保存成功"
   - 不通过：显示错误提示，阻止保存

## API配置

### 当前配置
- API端点：`https://open.bigmodel.cn/api/paas/v4/chat/completions`
- 模型：`glm-4`
- 超时时间：30秒

### 审核提示词
```
请检查以下宠物信息是否包含粗鲁、色情、低俗的词语：

宠物名字：[用户输入的名字]
宠物年龄：[用户输入的年龄]
宠物描述：[用户输入的描述]

请只回答"通过"或"不通过"，如果包含不当内容请说明原因。
```

## 测试功能

在开发阶段，添加了"测试API"按钮用于验证API连接是否正常。

## 注意事项

1. **网络权限**：已在 `Info.plist` 中添加网络访问权限
2. **错误处理**：包含完整的错误处理和用户提示
3. **安全性**：API密钥应通过环境变量管理，避免硬编码
4. **性能**：设置了30秒超时，避免长时间等待

## 生产环境建议

1. 将API密钥移到环境变量或安全的配置管理系统中
2. 添加API调用频率限制
3. 实现本地缓存机制，避免重复审核相同内容
4. 添加更详细的日志记录
5. 考虑添加离线模式或降级策略

## 故障排除

如果API调用失败，请检查：
1. 网络连接是否正常
2. API密钥是否有效
3. 智普AI服务是否可用
4. 请求格式是否符合API要求

可以通过控制台日志查看详细的API响应信息进行调试。 